/*! 2014 Baidu Inc. All Rights Reserved */
define("saber-dom/selector",function(){var exports={};return exports.g=function(t){if(!t)return null;else return"string"==typeof t?document.getElementById(t):t},exports.query=function(t,e){if("string"!=typeof t)return t;else return e=e||document.body,e.querySelector(t)},exports.queryAll=function(t,e){if(Array.isArray(t))return t;e=e||document.body;var n=e.querySelectorAll(t);return Array.prototype.slice.call(n)},exports.matches=function(t,e){var n=Element.prototype,i=n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector;if(i)return i.call(t,e);for(var r=exports.queryAll(e,t.parentNode),o=0;o<r.length;o++)if(r[o]==t)return!0;return!1},exports}),define("saber-dom/css",function(){function t(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})}function e(e){if("-"!==e.charAt(0)){var n=i.style,o=t(e);if(!(o in n)){o=e.charAt(0).toUpperCase()+e.substring(1);for(var a,s=0;a=r[s];s++)if(a+o in n){e="-"+a+"-"+e;break}}}return e}var exports={},n=document.defaultView.getComputedStyle,i=document.createElement("div"),r=["webkit","ms","o"];return exports.getStyle=function(i,r){return r=e(r),i.style[t(r)]||n(i).getPropertyValue(r)},exports.setStyle=function(n,i,r){i=e(i),n.style[t(i)]=r},exports.show=function(t){if("none"===exports.getStyle(t,"display"))t.style.display=null},exports.hide=function(t){t.style.display="none"},exports.addClass=function(t,e){if(t.classList)t.classList.add(e);else{for(var n=t.className?t.className.split(/\s+/):[],i=0;i<n.length;i++)if(n[i]===e)return t;n.push(e),t.className=n.join(" ")}return t},exports.removeClass=function(t,e){if(t.classList)t.classList.remove(e);else{for(var n=t.className?t.className.split(/\s+/):[],i=0;i<n.length;i++)if(n[i]===e)n.splice(i,1),i--;t.className=n.join(" ")}return t},exports.hasClass=function(t,e){if(t.classList)return t.classList.contains(e);else{for(var n=t.className.split(/\s+/),i=0;i<n.length;i++)if(n[i]===e)return!0;return!1}},exports.position=function(t,e){var n={},i=t.getBoundingClientRect();if(e){var r=e.getBoundingClientRect();n.left=i.left-r.left,n.top=i.top-r.top}else n.left=i.left+Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),n.top=i.top+Math.max(document.documentElement.scrollTop,document.body.scrollTop);return n},exports}),define("saber-dom/traversal",function(require){var t=require("./selector").matches,exports={};return exports.children=function(t){for(var e,n=[],i=t.children,r=0;e=i[r];r++)if(1==e.nodeType)n.push(e);return n},exports.closest=function(e,n,i){i=i||document;do{if(t(e,n))return e;if(e===i)return null}while((e=e.parentNode)&&e!==document);return null},exports}),define("saber-dom/data",function(){var exports={},t="data-";return exports.setData=function(e,n,i){e.setAttribute(t+n,i)},exports.getData=function(e,n){return e.getAttribute(t+n)},exports.removeData=function(e,n){e.removeAttribute(t+n)},exports}),define("saber-dom/main",function(require){function t(t,e){for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n];return t}var exports={};return t(exports,require("./selector")),t(exports,require("./css")),t(exports,require("./traversal")),t(exports,require("./data")),exports}),define("saber-dom",["saber-dom/main"],function(t){return t}),define("saber-promise/promise",function(){function t(t){return"[object Function]"==Object.prototype.toString.call(t)}function e(t){return"[object Object]"==Object.prototype.toString.call(t)}function n(i,r){if(e(r)||t(r)){var o;try{var a=r.then;if(t(a))a.call(r,function(t){if(!o)n(i,t),o=!0},function(t){if(!o)i.reject(t),o=!0});else i.fulfill(r)}catch(s){if(!p)throw s;else if(!o)c(s),i.reject(s)}}else i.fulfill(r)}function i(t,e,i){return function(r){try{var o=i(r);if(o===e)throw new TypeError;n(t,o)}catch(a){if(p)c(a),t.reject(a);else throw a}}}function r(t,e,n){if(t.status==e)d(function(){n(t.data)});else if(e==l.FULFILLED)t.fulfillList.push(n);else if(e==l.REJECTED)t.rejectList.push(n)}function o(t){var e=t.status==l.FULFILLED?t.fulfillList:t.rejectList;if(u(t),!(e.length<=0))d(function(){for(var n;n=e.shift();)n(t.data)})}function a(e,n,o){var a=new f,u=s(a);if(t(n))n=i(a,u,n);else n=function(t){a.fulfill(t)};if(r(e,l.FULFILLED,n),t(o))o=i(a,u,o);else o=function(t){a.reject(t)};return r(e,l.REJECTED,o),u}function s(t){return{then:function(e,n){return a(t,e,n)}}}function u(t){var e=t.status==l.FULFILLED?"resolve":"reject";if(h)f.emit(e,t.data)}function c(t){if(h)f.emit("exception",t)}function f(){this.status=l.PENDING,this.fulfillList=[],this.rejectList=[]}var l={PENDING:0,FULFILLED:1,REJECTED:2},p=!0,h=!1,d=function(){function t(){for(var t=i.length,e=0;t>e;e++)i[e]();i.splice(0,e)}var e,n,i=[],r="promise";if("function"==typeof setImmediate)e=setImmediate;else if(n=window.MutationObserver||window.webKitMutationObserver){var o=new n(function(e){var n=e[0];if(n.attributeName==r)t()}),a=document.createElement("div");o.observe(a,{attributes:!0}),e=function(t){i.push(t),a.setAttribute(r,Date.now?Date.now():(new Date).getTime())}}else if("function"==typeof window.postMessage)window.addEventListener("message",function(e){if(e.source==window&&e.data==r)t()},!1),e=function(t){i.push(t),window.postMessage(r,"*")};else e=function(t){setTimeout(t,0)};return e}();return f.enableGlobalEvent=function(t){t.mixin(this),h=!0},f.disableExceptionCapture=function(){p=!1},f.enableExceptionCapture=function(){p=!0},f.all=function(t){function e(e){return function(n){if(o[e]=n,r++,r>=t.length)i.fulfill(o)}}function n(t){i.reject(t)}if(!Array.isArray(t))t=Array.prototype.slice.call(arguments);var i=new f,r=0,o=[];return t.forEach(function(t,i){t.then(e(i),n)}),i.promise()},f.promise=function(t){var e=new f;return t(e),e.promise()},f.rejected=function(t){return this.promise(function(e){e.reject(t)})},f.fulfilled=function(t){return this.promise(function(e){e.fulfill(t)})},f.resolved=f.fulfilled,f.prototype.fulfill=function(t){if(this.status==l.PENDING)this.data=t,this.status=l.FULFILLED,o(this)},f.prototype.resolve=f.prototype.fulfill,f.prototype.reject=function(t){if(this.status==l.PENDING)this.data=t,this.status=l.REJECTED,o(this)},f.prototype.promise=function(){return s(this)},f}),define("saber-promise",["saber-promise/promise"],function(t){return t}),define("saber-emitter/emitter",function(){function t(){}var e=t.prototype;return e._getEvents=function(){if(!this._events)this._events={};return this._events},e._getMaxListeners=function(){if(isNaN(this.maxListeners))this.maxListeners=10;return this.maxListeners},e.on=function(t,e){var n=this._getEvents(),i=this._getMaxListeners();n[t]=n[t]||[];var r=n[t].length;if(r>=i&&0!==i)throw new RangeError("Warning: possible Emitter memory leak detected. "+r+" listeners added.");return n[t].push(e),this},e.once=function(t,e){function n(){i.off(t,n),e.apply(this,arguments)}var i=this;return n.listener=e,this.on(t,n),this},e.off=function(t,e){var n=this._getEvents();if(0===arguments.length)return this._events={},this;var i=n[t];if(!i)return this;if(1===arguments.length)return delete n[t],this;for(var r,o=0;o<i.length;o++)if(r=i[o],r===e||r.listener===e){i.splice(o,1);break}return this},e.emit=function(t){var e=this._getEvents(),n=e[t],i=Array.prototype.slice.call(arguments,1);if(n){n=n.slice(0);for(var r=0,o=n.length;o>r;r++)n[r].apply(this,i)}return this},e.listeners=function(t){var e=this._getEvents();return e[t]||[]},e.setMaxListeners=function(t){return this.maxListeners=t,this},t.mixin=function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e},t}),define("saber-emitter",["saber-emitter/emitter"],function(t){return t}),define("saber-lang/bind",function(){function t(t,e){var n=Array.prototype.slice.call(arguments,2);return function(){return t.apply(e,n.concat(Array.prototype.slice.call(arguments)))}}return t}),define("saber-tap/tap",function(require){"use strict";function t(){if(!("ontouchstart"in window))return!0;if(c||o&&f)return!0;else return!1}function e(t){var e=t.onclick;t.addEventListener("click",function(t){e(t)},!1),t.onclick=null}function n(n){if(this.layer=n,this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.startX=0,this.startY=0,this.lastTouchIdentifier=0,this.boundary=10,!n||!n.nodeType)throw new TypeError("layer must be a HTMLElement.");if(!t()){if(this.onClick=i(this.onClick,this),this.onMouse=i(this.onMouse,this),this.onTouchStart=i(this.onTouchStart,this),this.onTouchMove=i(this.onTouchMove,this),this.onTouchEnd=i(this.onTouchEnd,this),this.onTouchCancel=i(this.onTouchCancel,this),this.bindEvents(),!Event.prototype.stopImmediatePropagation)n.addEventListener=function(t,e,i){var r=Node.prototype.addEventListener;if("click"===t){if(!e.hijacked)e.hijacked=function(t){if(!t.propagationStopped)e(t)};r.call(n,t,e.hijacked,i)}else r.call(n,t,e,i)},n.removeEventListener=function(t,e,i){var r=Node.prototype.removeEventListener;if("click"===t)r.call(n,t,e.hijacked||e,i);else r.call(n,t,e,i)};if("function"==typeof n.onclick)e(n)}}var i=require("saber-lang/bind"),r=navigator.userAgent,o=r.indexOf("Android")>0,a=/iP(ad|hone|od)/.test(r),s=a&&/OS 4_\d(_\d)?/.test(r),u=a&&/OS ([6-9]|\d{2})_\d/.test(r),c="chrome"in window,f=r.indexOf("UCBrowser")>0;return n.prototype.bindEvents=function(){var t=this.layer;if(o)t.addEventListener("mouseover",this.onMouse,!0),t.addEventListener("mousedown",this.onMouse,!0),t.addEventListener("mouseup",this.onMouse,!0);t.addEventListener("click",this.onClick,!0),t.addEventListener("touchstart",this.onTouchStart,!1),t.addEventListener("touchmove",this.onTouchMove,!1),t.addEventListener("touchend",this.onTouchEnd,!1),t.addEventListener("touchcancel",this.onTouchCancel,!1)},n.prototype.onMouse=function(t){if(!this.targetElement)return!0;if(t.forwardedTouchEvent)return!0;if(!t.cancelable)return!0;if(!this.needsClick(this.targetElement)||this.cancelNextClick){if(t.stopImmediatePropagation)t.stopImmediatePropagation();else t.propagationStopped=!0;return t.stopPropagation(),t.preventDefault(),!1}return!0},n.prototype.getTargetElementFromEventTarget=function(t){if(t.nodeType===Node.TEXT_NODE)return t.parentNode;else return t},n.prototype.updateScrollParent=function(t){var e=t.tapScrollParent;if(!e||!e.contains(t)){var n=t;do{if(n.scrollHeight>n.offsetHeight){e=n,t.tapScrollParent=n;break}n=n.parentElement}while(n)}if(e)e.tapLastScrollTop=e.scrollTop},n.prototype.onClick=function(t){if(this.trackingClick)return this.targetElement=null,this.trackingClick=!1,!0;if("submit"===t.target.type&&0===t.detail)return!0;var e=this.onMouse(t);if(!e)this.targetElement=null;return e},n.prototype.onTouchStart=function(t){if(t.targetTouches.length>1)return!0;var e,n=this.getTargetElementFromEventTarget(t.target),i=t.targetTouches[0];if(a){if(e=window.getSelection(),e.rangeCount&&!e.isCollapsed)return!0;if(!this.isIOS4){if(i.identifier===this.lastTouchIdentifier)return t.preventDefault(),!1;this.lastTouchIdentifier=i.identifier,this.updateScrollParent(n)}}if(this.trackingClick=!0,this.trackingClickStart=t.timeStamp,this.targetElement=n,this.startX=i.pageX,this.startY=i.pageY,t.timeStamp-this.lastClickTime<200)t.preventDefault();return!0},n.prototype.touchHasMoved=function(t){var e=t.changedTouches[0],n=this.boundary;if(Math.abs(e.pageX-this.startX)>n||Math.abs(e.pageY-this.startY)>n)return!0;else return!1},n.prototype.onTouchMove=function(t){if(!this.trackingClick)return!0;var e=this.getTargetElementFromEventTarget(t.target);if(this.targetElement!==e||this.touchHasMoved(t))this.trackingClick=!1,this.targetElement=null;return!0},n.prototype.findControl=function(t){if(void 0!==t.control)return t.control;if(t.htmlFor)return document.getElementById(t.htmlFor);else return t.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},n.prototype.focus=function(t){if(a&&t.setSelectionRange&&0!==t.type.indexOf("date")&&"time"!==t.type){var e=t.value.length;t.setSelectionRange(e,e)}else t.focus()},n.prototype.needsFocus=function(t){switch(t.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!o;case"input":switch(t.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!t.disabled&&!t.readOnly;default:return/\bneedsfocus\b/.test(t.className)}},n.prototype.needsClick=function(t){switch(t.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(t.disabled)return!0;break;case"input":if(a&&"file"===t.type||t.disabled)return!0;break;case"label":case"video":return!0}return/\bneedsclick\b/.test(t.className)},n.prototype.sendClick=function(t,e){if(document.activeElement&&document.activeElement!==t)document.activeElement.blur();var n=e.changedTouches[0],i=document.createEvent("MouseEvents");i.initMouseEvent(this.determineEventType(t),!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),i.forwardedTouchEvent=!0,t.dispatchEvent(i)},n.prototype.determineEventType=function(t){if(o&&"select"===t.tagName.toLowerCase())return"mousedown";else return"click"},n.prototype.onTouchEnd=function(t){var e=this.targetElement;if(!this.trackingClick)return!0;if(t.timeStamp-this.lastClickTime<200)return this.cancelNextClick=!0,!0;this.cancelNextClick=!1,this.lastClickTime=t.timeStamp;var n=this.trackingClickStart;if(this.trackingClick=!1,this.trackingClickStart=0,u){var i=t.changedTouches[0];e=document.elementFromPoint(i.pageX-window.pageXOffset,i.pageY-window.pageYOffset)||e,e.tapScrollParent=this.targetElement.tapScrollParent}var r=e.tagName.toLowerCase();if("label"===r){var c=this.findControl(e);if(c){if(this.focus(e),o)return!1;e=c}}else if(this.needsFocus(e)){if(t.timeStamp-n>100||a&&window.top!==window&&"input"===r)return this.targetElement=null,!1;if(this.focus(e),!s||"select"!==r)this.targetElement=null,t.preventDefault();return!1}if(a&&!s){var f=e.tapScrollParent;if(f&&f.tapLastScrollTop!==f.scrollTop)return!0}if(!this.needsClick(e))t.preventDefault(),this.sendClick(e,t);return!1},n.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},n.prototype.destroy=function(){var t=this.layer;if(o)t.removeEventListener("mouseover",this.onMouse,!0),t.removeEventListener("mousedown",this.onMouse,!0),t.removeEventListener("mouseup",this.onMouse,!0);t.removeEventListener("click",this.onClick,!0),t.removeEventListener("touchstart",this.onTouchStart,!1),t.removeEventListener("touchmove",this.onTouchMove,!1),t.removeEventListener("touchend",this.onTouchEnd,!1),t.removeEventListener("touchcancel",this.onTouchCancel,!1)},n.mixin=function(t){if("string"==typeof t)t=document.getElementById(t);return new n(t)},n}),define("saber-tap",["saber-tap/tap"],function(t){return t}),define("saber-lang/extend",function(){function t(t,e){for(var n=1,i=arguments.length;i>n;n++)if(e=arguments[n]){for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r]}else;return t}return t}),define("saber-lang/curry",function(){function t(t){var e=[].slice.call(arguments,1);return function(){var n=e.concat([].slice.call(arguments));return t.apply(this,n)}}return t}),define("saber-lang/inherits",function(){function t(t,e){var n=function(){};n.prototype=e.prototype;var i=t.prototype,r=t.prototype=new n;for(var o in i)r[o]=i[o];return t.prototype.constructor=t,t}return t}),define("saber-uri/component/Abstract",function(){function t(){var t=Array.prototype.slice.call(arguments);this.set.apply(this,t)}return t.prototype.get=function(){return this.data},t.prototype.set=function(t){this.data=t||""},t.prototype.add=function(t){this.set(t)},t.prototype.remove=function(){this.data=""},t.prototype.toString=function(){return this.data.toString()},t.prototype.equal=function(e){if(e instanceof t)e=e.get();return this.data==e},t}),define("saber-uri/component/Path",function(require){function t(t){if(!t)t="/";return t}function e(t){return t=t.split("/"),t.pop(),t.join("/")}function n(t,e){for(var n,i=0,r=t.length-1;n=t[r];r--)if("."==n)t.splice(r,1);else if(".."==n)t.splice(r,1),i++;else if(i)t.splice(r,1),i--;if(e)for(;i-->0;)t.unshift("..");return t}function i(t,e){o.call(this,t,e)}var r=require("saber-lang/inherits"),o=require("./Abstract");return i.resolve=function(t,i){if(i=i||"","/"==i.charAt(0))return i;var r="/"==t.charAt(0),o=!1;if(i)t=e(t),o="/"==i.charAt(i.length-1);else if(t.length>1)o="/"==t.charAt(t.length-1);var a=t.split("/").concat(i.split("/")).filter(function(t){return!!t});return a=n(a,!r),(r?"/":"")+a.join("/")+(o?"/":"")},r(i,o),i.prototype.set=function(t,e){if(e instanceof i)e=e.get();var n=[t||""];if(e)n.unshift(e);this.data=i.resolve.apply(i,n)},i.prototype.equal=function(e){var n=t(this.data);if(e instanceof i)e=t(e.get());else e=t(i.resolve(e||""));return n==e},i.prototype.resolve=function(t,e){if(t instanceof i)t=t.get();var n=[this.data];if(e)n.unshift(t);else n.push(t);this.data=i.resolve.apply(i,n)},i}),define("saber-uri/util/parse-query",function(){function t(t){var e={};t=t.split("&");var n,i;return t.forEach(function(t){if(t)if(t=t.split("="),n=t[0],i=t.length>=2?decodeURIComponent(t[1]):null,e[n]){if(!Array.isArray(e[n]))e[n]=[e[n]];e[n].push(i)}else e[n]=i}),e}return t}),define("saber-uri/util/stringify-query",function(){function t(t){var e,n=[];return Object.keys(t).forEach(function(i){if(e=t[i],!Array.isArray(e))e=[e];e.forEach(function(t){if(null===t)n.push(i);else n.push(i+"="+encodeURIComponent(t||""))})}),n.join("&")}return t}),define("saber-uri/component/Query",function(require){function t(t){return"[object Object]"==Object.prototype.toString.call(t)}function e(t){return"[object String]"==Object.prototype.toString.call(t)}function n(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!=e.length)return!1;t=t.slice(0),t=t.slice(0),t.sort(),e.sort();for(var n=!0,i=0,r=t.length;n&&r>i;i++)n=t[i]==e[i];return n}function i(e,i){if(!t(e)||!t(i))return!1;var r=Object.keys(e),o=Object.keys(i);if(r.length!=o.length)return!1;for(var a,s,u=!0,c=0;u&&(a=r[c]);c++){if(!i.hasOwnProperty(a)){u=!1;break}if(s=e[a],Array.isArray(s))u=n(s,i[a]);else u=s==i[a]}return u}function r(t,e,n){var i=n[t];if(i){if(!Array.isArray(i))i=[i];if(Array.isArray(e))i=i.concat(e);else i.push(e)}else i=e;return n[t]=i,n}function o(t){t=t||{},u.call(this,t)}var a=require("saber-lang/inherits"),s=require("saber-lang/extend"),u=require("./Abstract"),c=require("../util/parse-query"),f=require("../util/stringify-query"),l="?";return a(o,u),o.prototype.set=function(){if(1==arguments.length){var e=arguments[0];if(t(e))this.data=s({},e);else this.data=c(e)}else this.data[arguments[0]]=arguments[1]},o.prototype.get=function(t){return t?this.data[t]:s({},this.data)},o.prototype.toString=function(t){t=t||l;var e=f(this.data);return e?t+e:""},o.prototype.equal=function(t){if(e(t))t=c(t);else if(t instanceof o)t=t.get();return i(this.data,t)},o.prototype.add=function(e,n){var i=this.data;if(t(e))Object.keys(e).forEach(function(t){r(t,e[t],i)});else r(e,n,i);this.data=i},o.prototype.remove=function(t){if(!t)this.data={};else if(this.data.hasOwnProperty(t))delete this.data[t]},o}),define("saber-router/config",function(){return{index:"",path:"/"}}),define("saber-router/URL",function(require){function t(t){if("/"==t.charAt(t.length-1))t+=r.index;return t}function e(t,e){e=e||{};var r=e.base||{};if(t=t.trim(),"#"==t.charAt(0))t=t.substring(1);t=t.split(o);var a=t[0].trim();this.isRelative="/"!==a.charAt(0),this.path=new n(a,r.path);var s=t[1]&&t[1].trim();if(this.query=new i(s||""),e.query)this.query.add(e.query)}var n=require("saber-uri/component/Path"),i=require("saber-uri/component/Query"),r=require("./config"),o="~";return e.prototype.toString=function(){return this.path.toString()+this.query.toString(o)},e.prototype.equalPath=function(e){var n=t(this.path.get());return e=t(e),n==e},e.prototype.equal=function(t){return this.query.equal(t.query)&&this.equalPath(t.path.get())},e.prototype.getQuery=function(){return this.query.get()},e.prototype.addQuery=function(t,e){this.query.add(t,e)},e.prototype.getPath=function(){return this.path.get()},e}),define("saber-router/main",function(require){function t(t){var e=-1;return l.some(function(n,i){if(n.path.toString()==t.toString())e=i;return-1!=e}),e}function e(t,e){for(var n,i={},r=e.params||[],o=t.match(e.path)||[],a=1;a<o.length;a++)n=r[a-1]||"$"+a,i[n]=o[a];return i}function n(t,e,n){return t=t||c.path,new u(t,{query:e,base:n})}function i(t,i){if(!(t instanceof u))t=n(t,null,f);if(t.equal(f)&&!i)return t;var r,o=s({},t.getQuery());if(l.some(function(n){if(n.path instanceof RegExp&&n.path.test(t.getPath()))r=n,o=s(e(t.getPath(),n),o);else if(t.equalPath(n.path))r=n;return!!r}),!r)throw new Error("can not find "+t.getPath());else r.fn.call(r.thisArg,t.getPath(),o);return f=t,t}function r(t){var e={params:[]};return e.path=t.replace(/:([^/~]+)/g,function(t,n){return e.params.push(n),"([^/~]+)"}),e.path=new RegExp(e.path),e}function o(t,e,n){var i={path:t,fn:e,thisArg:n};if(!(t instanceof RegExp)&&t.indexOf(":")>=0)i=s(i,r(t));l.push(i)}function a(){var t=i(location.hash);if(t.isRelative){var e=location.href.split("#")[0];history.replaceState({},document.title,e+"#"+t.toString())}}var s=require("saber-lang/extend"),u=require("./URL"),c=require("./config"),f={},l=[],exports={};return exports.config=function(t){t=t||{},s(c,t)},exports.add=function(e,n,i){if(t(e)>=0)throw new Error("path has been existed");o(e,n,i)},exports.remove=function(e){var n=t(e);if(n>=0)l.splice(n,1)},exports.clear=function(){l=[],f={}},exports.redirect=function(t,e,r){var o=Array.prototype.slice.call(arguments);if("[object Boolean]"==Object.prototype.toString.call(o[o.length-1]))r=o.pop(),e=o[1];t=n(t,e,f),i(t,r),location.hash="#"+t.toString()},exports.start=function(){window.addEventListener("hashchange",a,!1),exports.redirect(location.hash)},exports.stop=function(){window.removeEventListener("hashchange",a,!1)},exports}),define("saber-router",["saber-router/main"],function(t){return t}),define("saber-viewport/config",{transition:!0,duration:.3,timing:"ease",transform:!0,mask:!0}),define("saber-viewport/Page",function(require){function t(t){if(t.main&&t.main.parentNode)t.main.parentNode.removeChild(t.main);t.main=null,t.viewport=null}function e(t,e,n){n=n||{},r.mixin(this),this.url=t,this.viewport=e,this.cached=n.cached,this.main=n.main||document.createElement("div")}var n=require("saber-dom"),i=require("saber-promise"),r=require("saber-emitter"),o="data-viewport",a=o+"-bar",s=o+"-fixed";return e.prototype.getBar=function(){var t=this.main,e=n.queryAll("["+a+"]",t),i={};return e.forEach(function(t){i[t.getAttribute(a)]=t}),i},e.prototype.getFixed=function(){var t=this.main;return n.queryAll("["+s+"]",t)},e.prototype.clone=function(t){var n=new e(this.url,this.viewport,{cached:t.cached,main:this.main});return n},e.prototype.enter=function(t,e){if(!this.main)return i.rejected();else return this.viewport.transition(this,t,e)},e.prototype.remove=function(e){if(!this.cached||1==e)t(this);else if(this.main&&this.main.parentNode)this.main.parentNode.removeChild(this.main)},e}),define("saber-viewport/transition",function(require){function t(t,r){var o=new e;if(n.transition===!1||t===!1)return n.viewport.appendChild(r.backPage.main),o.fulfill(),o.promise();var a=i[t||n.transition];if(!a)throw new Error("can not find transition");if(!r.frontPage)n.viewport.appendChild(r.backPage.main),o.fulfill();else a(o,r);return o.promise()}var e=require("saber-promise"),n=require("./config"),i={};return t.register=function(t,e){i[t]=e},t}),define("saber-viewport/mask",function(){function t(){e=document.createElement("div"),e.className=exports.className,e.style.cssText+=";display:none;position:fixed;top:0;right:0;bottom:0;left:0;z-index:100",document.body.appendChild(e)}var e,exports={};return exports.className="saber-viewport-mask",exports.show=function(){if(!e)t();e.style.display=""},exports.hide=function(){if(!e)t();e.style.display="none"},exports}),define("saber-viewport/main",function(require){function t(){var t=c.viewport;t.style.position="relative"}function e(){var t=c.viewport,e=a.children(t);if(!(e.length<=0)){var n=new f("__blank__");e.forEach(function(t){n.main.appendChild(t)}),t.appendChild(n.main),r=n}}function n(t,e){if(t)t.emit("beforeleave");if(e.emit("beforeenter"),c.mask)p.show()}function i(t,e){if(c.mask)p.hide();if(t)t.emit("afterleave"),t.remove();e.emit("afterenter"),o=null,r=e}var r,o,a=require("saber-dom"),s=require("saber-lang/extend"),u=require("saber-lang/curry"),c=require("./config"),f=require("./Page"),l=require("./transition"),p=require("./mask"),h={},d={};return d.transition=function(t,e,a){if(t!==o)return Resolver.rejected();else return a=a||{},a.frontPage=r,a.backPage=t,n(r,t),l(e,a).then(u(i,r,t))},{init:function(n,i){if("string"==typeof n||n instanceof String)n=document.getElementById(n);c=s(c,i),c.viewport=n,t(),e()},load:function(t,e){var n,e=e||{};if(n=h[t],!n)n=new f(t,d,e);else n=n.clone(e);if(e.cached)h[t]=n;else if(h[t])delete h[t];if(o)if(o.remove(!0),h[o.url])delete h[o.url];return o=n}}}),define("saber-viewport",["saber-viewport/main"],function(t){return t}),define("saber-firework/Abstract",function(require){function t(t){var e,n=t.events||{};Object.keys(n).forEach(function(i){if(e=n[i],i.indexOf(":")<0)t.on(i,e);else{var o=i.split(":"),a=o[0].trim();if(i=o[1]&&o[1].trim(),a&&t[a]&&i)t[a].on(i,r(e,t))}})}function e(t){t=t||{},i(this,t),n.mixin(this)}var n=require("saber-emitter"),i=require("saber-lang/extend"),r=require("saber-lang/bind");return e.prototype.init=function(){t(this)},e.prototype.dispose=function(){},e}),function(t){function e(t,e){for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n];return t}function n(){this.raw=[],this.length=0}function i(){return"___"+L++}function r(t,e){var n=new Function;n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}function o(t){return R[t]}function a(t){return'"'+t.replace(/\x5C/g,"\\\\").replace(/"/g,'\\"').replace(/\x0A/g,"\\n").replace(/\x09/g,"\\t").replace(/\x0D/g,"\\r")+'"'}function s(t){var e=arguments;return t.replace(/\{([0-9]+)\}/g,function(t,n){return e[n-0+1]})}function u(t){return s('gv({0},["{1}"])',a(t),t.replace(/\[['"]?([^'"]+)['"]?\]/g,function(t,e){return"."+e}).split(".").join('","'))}function c(t){return t.replace(/\$\{([0-9a-z_\.\[\]'"-]+)\}/gi,function(t,e){return u(e)})}function f(t,e,n,i,r,o){for(var a=n.length,s=t.split(e),u=0,c=[],f=0,l=s.length;l>f;f++){var p=s[f];if(f){for(u++;;){var h=p.indexOf(n);if(0>h){c.push(p);break}else if(u=i?u-1:0,c.push(u>0?e:"",p.slice(0,h),u>0?n:""),p=p.slice(h+a),0===u)break}if(0===u)r(c.join("")),o(p),c=[]}else p&&o(p)}if(u>0&&c.length>0)o(e),o(c.join(""))}function l(t,e){this.value=t,this.engine=e}function p(t,e){this.value=t,this.engine=e,this.children=[]}function h(t,e){var n=t.stack,i=e?n.find(function(t){return t instanceof e}):n.bottom();if(i){var r;do{if(r=n.top(),!r.autoClose)throw new Error(r.type+" must be closed manually: "+r.value);r.autoClose(t)}while(r!==i)}return i}function d(t,e){if(!/^\s*([a-z0-9_-]+)\s*(\(\s*master\s*=\s*([a-z0-9_-]+)\s*\))?\s*/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.master=RegExp.$3,this.name=RegExp.$1,p.call(this,t,e),this.contents={}}function m(t,e){if(!/^\s*([a-z0-9_-]+)\s*(\(\s*master\s*=\s*([a-z0-9_-]+)\s*\))?\s*/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.master=RegExp.$3,this.name=RegExp.$1,p.call(this,t,e),this.contents={}}function v(t,e){if(!/^\s*([a-z0-9_-]+)\s*$/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.name=RegExp.$1,p.call(this,t,e)}function g(t,e){if(!/^\s*([a-z0-9_-]+)\s*$/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.name=RegExp.$1,p.call(this,t,e)}function y(t,e){if(!/^\s*([a-z0-9_-]+)\s*$/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.name=RegExp.$1,p.call(this,t,e)}function b(t,e){if(!/^\s*([a-z0-9_]+)\s*=([\s\S]*)$/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.name=RegExp.$1,this.expr=RegExp.$2,p.call(this,t,e)}function w(t,e){if(!/^\s*([a-z0-9_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.name=RegExp.$1,this.args=RegExp.$3,p.call(this,t,e)}function E(t,e){if(!/^\s*([a-z0-9_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.name=RegExp.$1,this.args=RegExp.$3,p.call(this,t,e)}function x(t,e){if(!/^\s*\$\{([0-9a-z_\.\[\]'"-]+)\}\s+as\s+\$\{([0-9a-z_]+)\}\s*(,\s*\$\{([0-9a-z_]+)\})?\s*$/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.list=RegExp.$1,this.item=RegExp.$2,this.index=RegExp.$4,p.call(this,t,e)}function k(t,e){p.call(this,t,e)}function T(t,e){k.call(this,t,e)}function S(t,e){p.call(this,t,e)}function A(t,e){e.targetOrMaster=t;var n=e.engine,i=t.name,r=t instanceof d,o=r?"targets":"masters";if(n[o][i])switch(n.options.namingConflict){case"override":n[o][i]=t,r&&e.targets.push(i);case"ignore":break;default:throw new Error((r?"Target":"Master")+" is exists: "+i)}else n[o][i]=t,r&&e.targets.push(i)}function _(t,e){F[t]=e,e.prototype.type=t}function C(t){this.options={commandOpen:"<!--",commandClose:"-->",defaultFilter:"html"},this.config(t),this.masters={},this.targets={},this.filters=e({},j)}function O(t,e){function i(){if(d.length>0){var t=d.join(""),n=new l(t,e);if(n.beforeAdd(c),u.top().addTextNode(n),d=[],e.options.strip&&c.current instanceof p)n.value=t.replace(/^[\x20\t\r]*\n/,"");c.current=n}}function r(t){return t instanceof o}var o,a=e.options.commandOpen,s=e.options.commandClose,u=new n,c={engine:e,targets:[],stack:u},d=[];return f(t,a,s,0,function(t){var n=/^\s*(\/)?([a-z]+)\s*(:([\s\S]*))?$/.exec(t);if(n&&(o=F[n[2].toLowerCase()])&&"function"==typeof o){i();var f=c.current;if(e.options.strip&&f instanceof l)f.value=f.value.replace(/\r?\n[\x20\t]*$/,"\n");if(n[1])f=u.find(r),f&&f.close(c);else{if(f=new o(n[4],e),"function"==typeof f.beforeOpen)f.beforeOpen(c);f.open(c)}c.current=f}else if(!/^\s*\/\//.test(t))d.push(a,t,s);o=null},function(t){d.push(t)}),i(),h(c),c.targets}n.prototype={push:function(t){this.raw[this.length++]=t},pop:function(){if(this.length>0){var t=this.raw[--this.length];return this.raw.length=this.length,t}},top:function(){return this.raw[this.length-1]},bottom:function(){return this.raw[0]},find:function(t){for(var e=this.length;e--;){var n=this.raw[e];if(t(n))return n}}};var L=178245,R={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},j={html:function(t){return t.replace(/[&<>"']/g,o)},url:encodeURIComponent,raw:function(t){return t}},N='var r="";',I="r+=",P=";",D="return r;";if("undefined"!=typeof navigator&&/msie\s*([0-9]+)/i.test(navigator.userAgent)&&RegExp.$1-0<8)N="var r=[],ri=0;",I="r[ri++]=",D='return r.join("");';l.prototype={getRendererBody:function(){if(!this.value||this.engine.options.strip&&/^\s*$/.test(this.value))return"";var t=this.engine.options.defaultFilter,e=[];return f(this.value,"${","}",1,function(n){if(n.indexOf("|")<0&&t)n+="|"+t;var i=n.split(/\s*\|\s*/),r=i[0],o="ts(",a=")";if(0===r.indexOf("*"))r=r.slice(1),o=a="";for(var s=[o,u(r),a],f=1,l=i.length;l>f;f++){var p=i[f];if(/^\s*([a-z0-9_-]+)(\((.*)\))?\s*$/i.test(p)){if(s.unshift('fs["'+RegExp.$1+'"]('),RegExp.$3)s.push(",",c(RegExp.$3));s.push(")")}}e.push(I,s.join(""),P)},function(t){e.push(I,a(t),P)}),e.join("")},getContent:function(){return this.value}},p.prototype={addChild:function(t){this.children.push(t)},open:function(t){var e=t.stack.top();this.parent=e,e&&e.addChild(this),t.stack.push(this)},close:function(t){for(;t.stack.pop().constructor!==this.constructor;);},addTextNode:function(t){this.addChild(t)},getRendererBody:function(){for(var t=[],e=this.children,n=0;n<e.length;n++)t.push(e[n].getRendererBody());return t.join("")}};var q='data=data||{};var v={},fs=engine.filters,hg=typeof data.get=="function",gv=function(n,ps){var p=ps[0],d=v[p];if(d==null){if(hg){return data.get(n);}d=data[p];}for(var i=1,l=ps.length;i<l;i++)if(d!=null)d = d[ps[i]];return d;},ts=function(s){if(typeof s==="string"){return s;}if(s==null){s="";}return ""+s;};';r(d,p),r(m,p),r(v,p),r(g,p),r(y,p),r(b,p),r(w,p),r(E,p),r(x,p),r(k,p),r(T,k),r(S,p);
var M={READING:1,READED:2,APPLIED:3,READY:4};m.prototype.close=m.prototype.autoClose=d.prototype.close=d.prototype.autoClose=function(t){p.prototype.close.call(this,t),this.state=this.master?M.READED:M.APPLIED,t.targetOrMaster=null},d.prototype.applyMaster=m.prototype.applyMaster=function(){if(this.state>=M.APPLIED)return 1;var t=this.engine.masters[this.master];if(t&&t.applyMaster()){this.children=[];for(var e=0,n=t.children.length;n>e;e++){var i=t.children[e];if(i instanceof g)this.children.push.apply(this.children,(this.contents[i.name]||i).children);else this.children.push(i)}return this.state=M.APPLIED,1}},d.prototype.isReady=function(){function t(i){for(var r=0,o=i.children.length;o>r;r++){var a=i.children[r];if(a instanceof y){var s=e.targets[a.name];n=n&&s&&s.isReady(e)}else if(a instanceof p)t(a)}}if(this.state>=M.READY)return 1;var e=this.engine,n=1;if(this.applyMaster())return t(this),n&&(this.state=M.READY),n;else return void 0},d.prototype.getRenderer=function(){if(this.renderer)return this.renderer;if(this.isReady()){var t=new Function("data","engine",[q,N,this.getRendererBody(),D].join("\n")),e=this.engine;return this.renderer=function(n){return t(n,e)},this.renderer}return null},d.prototype.getContent=function(){if(this.isReady()){for(var t=[],e=this.children,n=0;n<e.length;n++)t.push(e[n].getContent());return t.join("")}return""},d.prototype.open=m.prototype.open=function(t){h(t),p.prototype.open.call(this,t),this.state=M.READING,A(this,t)},y.prototype.open=b.prototype.open=E.prototype.open=function(t){var e=t.stack.top();this.parent=e,e.addChild(this)},E.prototype.beforeOpen=y.prototype.beforeOpen=b.prototype.beforeOpen=x.prototype.beforeOpen=w.prototype.beforeOpen=k.prototype.beforeOpen=l.prototype.beforeAdd=function(t){if(!t.stack.bottom()){var e=new d(i(),t.engine);e.open(t)}},E.prototype.close=y.prototype.close=S.prototype.close=b.prototype.close=function(){},y.prototype.getContent=function(){var t=this.engine.targets[this.name];return t.getContent()},y.prototype.getRendererBody=function(){var t=this.engine.targets[this.name];return t.getRendererBody()},E.prototype.getRendererBody=function(){return s("{0}engine.render({2},{{3}}){1}",I,P,a(this.name),c(this.args.replace(/(^|,)\s*([a-z0-9_]+)\s*=/gi,function(t,e,n){return(e||"")+a(n)+":"})))},b.prototype.getRendererBody=function(){if(this.expr)return s("v[{0}]={1};",a(this.name),c(this.expr));else return""},k.prototype.getRendererBody=function(){var t=s("if({0}){{1}}",c(this.value),p.prototype.getRendererBody.call(this)),e=this["else"];if(e)return[t,s("else{{0}}",e.getRendererBody())].join("");else return t},x.prototype.getRendererBody=function(){return s('var {0}={1};if({0} instanceof Array)for (var {4}=0,{5}={0}.length;{4}<{5};{4}++){v[{2}]={4};v[{3}]={0}[{4}];{6}}else if(typeof {0}==="object")for(var {4} in {0}){v[{2}]={4};v[{3}]={0}[{4}];{6}}',i(),u(this.list),a(this.index||i()),a(this.item),i(),i(),p.prototype.getRendererBody.call(this))},w.prototype.getRendererBody=function(){var t=this.args;return s("{2}fs[{5}]((function(){{0}{4}{1}})(){6}){3}",N,D,I,P,p.prototype.getRendererBody.call(this),a(this.name),t?","+c(t):"")},v.prototype.open=function(t){h(t,v),p.prototype.open.call(this,t),t.targetOrMaster.contents[this.name]=this},g.prototype.open=function(t){h(t,g),p.prototype.open.call(this,t)},v.prototype.autoClose=k.prototype.autoClose=p.prototype.close,g.prototype.autoClose=function(t){var e=this.parent.children;e.push.apply(e,this.children),this.children.length=0,this.close(t)},k.prototype.addChild=function(t){var e=this["else"];(e?e.children:this.children).push(t)},T.prototype.open=function(t){var e=new S;e.open(t);var n=h(t,k);n.addChild(this),t.stack.push(this)},S.prototype.open=function(t){var e=h(t,k);e["else"]=this,t.stack.push(e)};var F={};_("target",d),_("master",m),_("content",v),_("contentplaceholder",g),_("import",y),_("use",E),_("var",b),_("for",x),_("if",k),_("elif",T),_("else",S),_("filter",w),C.prototype.config=function(t){e(this.options,t)},C.prototype.compile=C.prototype.parse=function(t){if(t){var e=O(t,this);if(e.length)return this.targets[e[0]].getRenderer()}return new Function('return ""')},C.prototype.getRenderer=function(t){var e=this.targets[t];if(e)return e.getRenderer();else return void 0},C.prototype.get=function(t){var e=this.targets[t];if(e)return e.getContent();else return""},C.prototype.render=function(t,e){var n=this.getRenderer(t);if(n)return n(e);else return""},C.prototype.addFilter=function(t,e){if("function"==typeof e)this.filters[t]=e};var B=new C;if(B.Engine=C,"object"==typeof exports&&"object"==typeof module)exports=module.exports=B;else if("function"==typeof define&&define.amd)define("etpl/main",B);else t.etpl=B}(this),define("etpl",["etpl/main"],function(t){return t}),define("saber-firework/event",function(require){function t(t){return"function"==typeof t}function e(t){var e;return y.some(function(n){if(n.detect(t))e=n;return!!e}),e}function n(t,e,n){var i=!1,r=h.queryAll(e,n);return r.some(function(e){return i=e==t}),i}function i(t,e){for(var i=e.target,r=e.type,o=[],a=t.handlers[r]||[];a.delegateCount&&i&&i!=t.ele;){for(var s,u=a.delegateCount,c=0;u>c&&(s=a[c]);c++)if(n(i,s.selector,t.ele)){var f=d({},s);f.thisArg=i,o.push(f)}i=i.parentNode}return o=o.concat(a.slice(a.delegateCount||0))}function r(t){return function(e){var n=i(t,e);e=s(e),n.some(function(n){var i=n.thisArg||t.ele,r=n.fn.call(i,e);if(r===!1)e.preventDefault(),e.stopPropagation();return e.isPropagationStopped()})}}function o(t,n){var i=t.commonEventHandler,r=e(n);if(r)r.on(t.ele,n,i);else t.ele.addEventListener(n,i,!1)}function a(t,n){var i=t.commonEventHandler,r=e(n);if(r)r.off(t.ele,n,i);else t.ele.removeEventListener(n,i,!1)}function s(t){var e=t.stopPropagation;return t.stopPropagation=function(){e.call(this),t[v]=!0},t.isPropagationStopped=function(){return!!t[v]},t}function u(t){return t[m]}function c(t){var e=++g;return t[m]=e,e}function f(t){try{delete t[m]}catch(e){}}function l(t){this.uid=c(t),this.ele=t,this.handlers={},this.commonEventHandler=r(this),b[this.uid]=this}function p(t){var e=u(t);if(e)return b[e];else return new l(t)}var h=require("saber-dom"),d=require("saber-lang/extend"),m="_event_uid",v="_stopped",g=0,y=[],b={};l.prototype.on=function(e,n,i){if(t(n))i=n,n=void 0;var r=this.handlers[e];if(!r)r=this.handlers[e]=[],r.delegateCount=0,o(this,e);var a={fn:i,selector:n};if(n)r.delegateCount++,r.splice(r.delegateCount-1,0,a);else r.push(a)},l.prototype.off=function(e,n,i){if(t(n))i=n,n=void 0;var r=this.handlers[e]||[];if(r.some(function(t,e){var o=!1;if(t.fn==i&&t.selector==n)r.splice(e,1),o=!0;return o}),r.length<=0)a(this,e)},l.prototype.dispose=function(){var t=this;f(t.ele),Object.keys(t.handlers).forEach(function(e){a(t,e)}),this.ele=null};var exports={};return exports.on=function(t,e,n,i){var r=p(t);r.on(e,n,i)},exports.off=function(t,e,n,i){var r=p(t);r.off(e,n,i)},exports.one=function(e,n,i,r){if(t(i))r=i,i=void 0;var o=function(){var t=Array.prototype.slice.call(arguments),a=r.apply(this,t);return exports.off(e,n,i,o),a};exports.on(e,n,i,o)},exports.clear=function(t){var e=p(t);e.dispose()},exports.register=function(t){if(t.init)t.init();y.push(t)},exports}),define("saber-firework/config",{index:"index",path:"/",template:[],viewport:{transition:!1},processor:{transition:!1},timeout:300}),define("saber-firework/View",function(require){function t(t,e){return function(n){return e.call(t,this,n)}}function e(e){var n,i,r,o=e.domEvents||{};Object.keys(o).forEach(function(a){r=t(e,o[a]),a=a.split(":"),n=a[0].trim(),i=a[1]?a[1].trim():void 0,e.attachEvent(e.main,n,i,r)})}function n(t){return"[object String]"==Object.prototype.toString.call(t)}function i(t,e){if(!Array.isArray(e))e=[e];e=e.concat(c.template||[]),e=e.join("");var n=new s.Engine,i=n.compile(e),r=n.render;t.template=n,t.template.render=function(t,e){var n="";if(arguments.length<2||!t)n=i(t||e);else n=r.call(this,t,e);return n}}function r(t){t=t||{},f.call(this,t),this.init(),t.template=this.template}var o=require("saber-lang/inherits"),a=require("saber-dom"),s=require("etpl"),u=require("./event"),c=require("./config"),f=require("./Abstract");return o(r,f),r.prototype.init=function(){if(this.template=this.template||"",Array.isArray(this.template)||n(this.template))i(this,this.template);this.bindElements=[],f.prototype.init.call(this)},r.prototype.setMain=function(t){this.main=t},r.prototype.render=function(t){if(this.main){if(this.className)this.main.className+=" "+this.className;this.emit("beforerender",t),this.main.innerHTML=this.template.render(this.templateMainTarget,t)}},r.prototype.ready=function(){e(this),this.emit("ready")},r.prototype.query=function(t){return a.query(t,this.main||document.body)},r.prototype.queryAll=function(t){return a.queryAll(t,this.main||document.body)},r.prototype.attachEvent=function(t,e,n,i){if(this.bindElements.indexOf(t)<0)this.bindElements.push(t);u.on(t,e,n,i)},r.prototype.detachEvent=function(t,e,n,i){u.off(t,e,n,i)},r.prototype.dispose=function(){this.emit("dispose"),this.bindElements.forEach(function(t){u.clear(t)}),this.bindElements=[],this.main=null},r.prototype.leave=function(){this.emit("leave")},r.prototype.sleep=function(){this.emit("sleep")},r.prototype.wakeup=function(){this.emit("wakeup")},r}),define("saber-firework/Model",function(require){function t(t){i.call(this,t),this.init()}var e=require("saber-lang/inherits"),n=require("saber-promise"),i=require("./Abstract");return e(t,i),t.prototype.fetch=function(){return n.resolved({})},t}),define("saber-firework/Action",function(require){function t(t){a.call(this,t),this.init(),this.emit("init")}var e=require("saber-lang/inherits"),n=require("saber-lang/extend"),i=require("saber-lang/bind"),r=require("saber-router"),o=require("saber-promise"),a=require("./Abstract"),s=require("./View"),u=require("./Model");return e(t,a),t.prototype.init=function(){var t;if(this.view&&this.view.constructor!==Object)t=this.view.constructor;else t=s;if(this.view=new t(this.view),this.model&&this.model.constructor!==Object)t=this.model.constructor;else t=u;this.model=new t(this.model),a.prototype.init.call(this)},t.prototype.enter=function(t,e,r){return this.url=t,this.query=n({},e),this.view.setMain(r),this.emit("enter"),this.model.fetch(this.query).then(i(this.view.render,this.view))},t.prototype.redirect=function(t,e,n){r.redirect(t,e,n)},t.prototype.wakeup=function(t,e){return this.url=t,this.query=n({},e),this.emit("wakeup"),this.view.wakeup(),o.resolved()},t.prototype.ready=function(){this.emit("ready"),this.view.ready()},t.prototype.complete=function(){this.emit("complete")},t.prototype.leave=function(){this.emit("leave"),this.view.leave(),this.dispose()},t.prototype.sleep=function(){this.emit("sleep"),this.view.sleep()},t.prototype.dispose=function(){this.view.dispose(),this.model.dispose()},t}),define("saber-firework/main",function(require){function t(t){var e=v.processor||{};return e[t]}function e(t){if(t==y)w.statusTimer=setTimeout(function(){w.status=g},v.timeout);else if(t==g)clearTimeout(w.statusTimer);w.status=t}function n(){w.action.complete(),e(g),r()}function i(e){if(w.action)if(w.route.cached)w.action.sleep();else w.action.leave();var i;if(e.cached)i=b[e.path];if(!i){var r;if(e.action&&e.action.constructor!==Object)r=e.action.constructor;else r=m;i=new r(e.action)}var o=e.transition||{},a=t("transition");if(a)f(o,a(e,w.route)||{});if(e.path==w.path)o.type=!1;var s=d.load(e.path,{cached:e.cached});s.on("afterenter",l(exports.emit,exports,"afterload",s,w.page)),exports.emit("beforeload",s,w.page);var u;if(!b[e.path])u=i.enter(e.path,e.query,s.main).then(function(){return s.enter(o.type,o)}).then(function(){i.ready()});else i.wakeup(e.path,e.query),u=s.enter(o.type,o);if(u.then(n),e.cached)b[e.path]=i;w.route=e,w.page=s,w.action=i,w.path=e.path}function r(){if(s&&w.status==g)e(y),i(s),s=null}function o(t,e,n){s=f({},t),s.path=e,s.query=n,r()}function a(t){var e=f(v,t);if(!Array.isArray(e.template))e.template=[e.template];return e}var s,u=require("saber-emitter"),c=require("saber-tap"),f=require("saber-lang/extend"),l=require("saber-lang/bind"),p=require("saber-lang/curry"),h=require("saber-router"),d=require("saber-viewport"),m=require("./Action"),v=require("./config"),g=0,y=1,b={},w={};w.status=g;var exports={};return u.mixin(exports),exports.load=function(t){if(!Array.isArray(t))t=[t];t.forEach(function(t){h.add(t.path,p(o,t))})},exports.start=function(t,e){var n=a(e);d.init(t,n.viewport),c.mixin(document.body),h.config({index:n.index,path:n.path}),h.start()},exports}),define("saber-firework",["saber-firework/main"],function(t){return t}),define("saber-run/transition",function(require){function t(t,e){var n,i=t.getAttribute(l);if(i)i=parseInt(i,10),n=f[i];else i=f.length,t.setAttribute(l,i);n=n||[],n.push(e),f[i]=n}function e(t,e){var n=t.getAttribute(l);if(n){n=parseInt(n,10);var i=f[n]||[];i.some(function(t,n,i){return t==e&&i.splice(n,1)})}}function n(t){var e=t.getAttribute(l);if(e){e=parseInt(e,10);var n=f[e]||[];n.forEach(function(e){e.call(t,!0)})}}function i(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})}function r(t){if("-"!==t.charAt(0)){var e=u.style,n=i(t);if(!(n in e)){n=t.charAt(0).toUpperCase()+t.substring(1);for(var r,o=0;r=c[o];o++)if(r+n in e){t="-"+r+"-"+t;break}}}return t}var o=require("saber-dom"),a=require("saber-promise"),exports={},s=["transitionend","webkitTransitionEnd","oTransitionEnd","MSTransitionEnd","otransitionend"],u=document.createElement("div"),c=["webkit","ms","o"],f=[],l="data-transition-event";return exports.onTransitionEnd=function(e,n,i){s.forEach(function(t){e.addEventListener(t,n,i||!1)}),t(e,n)},exports.unTransitionEnd=function(t,n,i){s.forEach(function(e){t.removeEventListener(e,n,i||!1)}),e(t,n)},exports.oneTransitionEnd=function(t,e,n){var i=function(r){if(e.call(t,r)!==!1)exports.unTransitionEnd(t,i,n)};exports.onTransitionEnd(t,i,n)},exports.transition=function(t,e,n){if(!t||!e)return a.resolved();n=n||{},n.ease=n.ease||n.timing||"ease",n.delay=n.delay||0,n.duration=n.duration||0;var i=[],s={};Object.keys(e).forEach(function(e){s[e]=o.getStyle(t,e)}),Object.keys(e).forEach(function(n){if(s[n]!=e[n])i.push(n),o.setStyle(t,n,e[n])});var u=new a,c=function(e){var n=!0;if(e===!0||i.length<=1)u.fulfill(),o.setStyle(t,"transition","");else i.pop(),n=!1;return n};if(i.length>0&&n.duration)exports.oneTransitionEnd(t,c),i.forEach(function(t,e){i[e]=r(t)}),o.setStyle(t,"transition-property",i.join(",")),o.setStyle(t,"transition-duration",n.duration+"s"),o.setStyle(t,"transition-timing-function",n.ease),o.setStyle(t,"transition-delay",n.delay+"s");else u.fulfill();return u.promise()},exports.stopTransition=function(t){o.setStyle(t,"transition-property","none"),n(t)},exports}),define("saber-run/Animation",function(require){function t(t){var e={};return t.replace(c,function(t,n,i){e[n.trim()]=i.trim()}),e}function e(t){var e=[];return Object.keys(t).forEach(function(n){e.push(n+"("+t[n]+")")}),e.join(" ")}function n(n,i){var r;return Object.keys(n).forEach(function(o){if(r=n[o],"transform"==o)n=t(i[o]||""),r=t(r),n=a(n,r),i[o]=e(n);else i[o]=r}),i}function i(t,e){this._action={},this._options={},this._defaultOptions={},this._main=t,e=e||{},this._defaultOptions.duration=e.duration||i.DURATION,this._defaultOptions.delay=e.delay||i.DELAY,this._defaultOptions.ease=u[e.ease]||u[i.EASE],this.reset(),this._promise=r.resolved()}var r=require("saber-promise"),o=require("saber-dom"),a=require("saber-lang/extend"),s=require("./transition"),u={"default":"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",linear:"cubic-bezier(0.250, 0.250, 0.750, 0.750)","ease-in-quad":"cubic-bezier(0.550, 0.085, 0.680, 0.530)","ease-in-cubic":"cubic-bezier(0.550, 0.055, 0.675, 0.190)","ease-in-quart":"cubic-bezier(0.895, 0.030, 0.685, 0.220)","ease-in-quint":"cubic-bezier(0.755, 0.050, 0.855, 0.060)","ease-in-sine":"cubic-bezier(0.470, 0.000, 0.745, 0.715)","ease-in-expo":"cubic-bezier(0.950, 0.050, 0.795, 0.035)","ease-in-circ":"cubic-bezier(0.600, 0.040, 0.980, 0.335)","ease-in-back":"cubic-bezier(0.600, -0.280, 0.735, 0.045)","ease-out-quad":"cubic-bezier(0.250, 0.460, 0.450, 0.940)","ease-out-cubic":"cubic-bezier(0.215, 0.610, 0.355, 1.000)","ease-out-quart":"cubic-bezier(0.165, 0.840, 0.440, 1.000)","ease-out-quint":"cubic-bezier(0.230, 1.000, 0.320, 1.000)","ease-out-sine":"cubic-bezier(0.390, 0.575, 0.565, 1.000)","ease-out-expo":"cubic-bezier(0.190, 1.000, 0.220, 1.000)","ease-out-circ":"cubic-bezier(0.075, 0.820, 0.165, 1.000)","ease-out-back":"cubic-bezier(0.175, 0.885, 0.320, 1.275)","ease-in-out-quad":"cubic-bezier(0.455, 0.030, 0.515, 0.955)","ease-in-out-cubic":"cubic-bezier(0.645, 0.045, 0.355, 1.000)","ease-in-out-quart":"cubic-bezier(0.770, 0.000, 0.175, 1.000)","ease-in-out-quint":"cubic-bezier(0.860, 0.000, 0.070, 1.000)","ease-in-out-sine":"cubic-bezier(0.445, 0.050, 0.550, 0.950)","ease-in-out-expo":"cubic-bezier(1.000, 0.000, 0.000, 1.000)","ease-in-out-circ":"cubic-bezier(0.785, 0.135, 0.150, 0.860)","ease-in-out-back":"cubic-bezier(0.680, -0.550, 0.265, 1.550)"},c=/([^(]+)\(([^)]+)\)/g;return i.DURATION=.3,i.DELAY=0,i.EASE="default",i.addAction=function(t,e){var n=this.prototype;if(!n.hasOwnProperty(t))n[t]=function(){var t,n=this,i=Array.prototype.slice.call(arguments),r=e.apply(n,i)||{};return Object.keys(r).forEach(function(e){t=r[e],n.set(e,t)}),n}},i.prototype.set=function(t,e){var i={};return i[t]=e,n(i,this._action),this},i.prototype.duration=function(t){return this._options.duration=t,this},i.prototype.delay=function(t){return this._options.delay=t,this},i.prototype.ease=function(t){return this._options.ease=u[t]||u["default"],this},i.prototype.reset=function(){return this._action={},this._options=a({},this._defaultOptions),this},i.prototype.end=function(){return s.stopTransition(this._main),this},i.prototype.run=function(){var t=this._main,e=a({},this._action);if(Object.keys(e).length<=0)return this;var i=this._options;return this.reset(),this._promise=this._promise.then(function(){var r;return Object.keys(e).forEach(function(i){if(r=e[i],"function"==typeof r)r=r(t)||{},delete e[i],n(r,e)}),s.transition(t,e,i)}),this},i.prototype.finish=function(t){return this._promise.then(t),this},i.addAction("moveTo",function(t,e){var n={};if(null!=t)n.left=t+"px";if(null!=e)n.top=e+"px";return n}),i.addAction("move",function(t,e){return{move:function(n){var i={},r=o.getStyle(n,"left");if(t&&r)t+=parseInt(r,10),i.left=t+"px";if(r=o.getStyle(n,"top"),e&&r)e+=parseInt(r,10),i.top=e+"px";return i}}}),i.addAction("rotateTo",function(t){return{transfor:"rotate("+t+"deg)"}}),i.addAction("rotate",function(e){return{rotate:function(n){var i=t(o.getStyle(n,"transform"));return e+=parseInt(i.rotate||"0",10),{transform:"rotate("+e+"deg)"}}}}),i.addAction("skewTo",function(t){return{transform:"skew("+t+"deg)"}}),i.addAction("skew",function(e){return{skew:function(n){var i=t(o.getStyle(n,"transform"));return e+=parseInt(i.skew||"0",10),{transform:"skew("+e+"deg)"}}}}),i.addAction("scaleTo",function(t){return{transform:"scale("+t+")"}}),i.addAction("scale",function(e){return{scale:function(n){var i=t(o.getStyle(n,"transform"));return e+=parseFloat(i.scale||"1"),{transform:"scale("+e+")"}}}}),i}),define("saber-run/util",function(){var exports={},t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,1e3/60)},e=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){clearTimeout(t)};return exports.requestAnimationFrame=function(e){return t.call(window,e)},exports.cancelAnimationFrame=function(t){e.call(window,t)},exports.now=function(){return Date.now?Date.now():(new Date).getTime()},exports}),define("saber-run/main",function(require){var t=require("saber-lang/extend"),e=require("./Animation"),exports={};return t(exports,require("./transition")),t(exports,require("./util")),exports.animation=function(t,n){return new e(t,n)},exports}),define("saber-run",["saber-run/main"],function(t){return t}),define("saber-viewport/util",function(require){var t=require("saber-dom"),exports={};return exports.setStyles=function(e,n,i){if(Object.keys(n).forEach(function(i){t.setStyle(e,i,n[i])}),i&&e.offsetWidth);},exports.getSize=function(e){var n,i=["top","right","bottom","left"],r={width:e.clientWidth,height:e.clientHeight};return i.forEach(function(i,o){n=parseInt(t.getStyle(e,"padding-"+i),10),r[o%2?"width":"height"]-=n}),r},exports.getPosition=function(t){var e=t.getBoundingClientRect(),n=document;return e.top+=Math.max(n.documentElement.scrollTop,n.body.scrollTop),e.left+=Math.max(n.documentElement.scrollLeft,n.body.scrollLeft),e},exports}),define("saber-viewport/transition/slide",function(require){function t(t,e,n,i){var r;Object.keys(d).forEach(function(o){if(r=d[o],r[t])r[t](e,n,i)})}function e(e,n,i){var r=p.viewport,o=e.main,a=n.main,s=document.createElement("div"),u=o.offsetWidth,c={width:2*u+"px"};if(l.setStyles(s,c),s.appendChild(o),i.direction==h.LEFT)s.insertBefore(a,o);else s.appendChild(a);if(l.setStyles(o,{"float":"left",width:u+"px",position:"relative"}),l.setStyles(a,{"float":"left",width:u+"px",position:"relative"}),r.appendChild(s),t("before",e,n,i),i.direction==h.LEFT)c=i.transform?{transform:"translate3d(-"+e.main.offsetWidth+"px, 0, 0)"}:{marginLeft:-e.main.offsetWidth+"px"};else if(i.transform)c.transform="translate3d(0, 0, 0)";return l.setStyles(s,c,!0),s}function n(t,e){var n=[];return Object.keys(t).forEach(function(t){if(t in e)n.push(t)}),n}function i(t,e,i){var r=t.getBar(),o=e.getBar(),a=n(r||{},o||{}),u=[];return a.forEach(function(t){var e={front:r[t],back:o[t]};e.change=e.front.getAttribute("data-name")!=e.back.getAttribute("data-name");var n,a=e.front,c=l.getPosition(a),f=s.getStyle(a,"position");if("fixed"!=f&&"position"!=f)n=document.createElement(a.tagName),n.className=a.className,n.style.cssText+=";"+a.style.cssText+";padding:0;border:0;width:"+a.offsetWidth+"px;height:"+a.offsetHeight+"px";else n=document.createElement("ins"),n.style.display="none";if(e.frontBlock=n,a.parentNode.insertBefore(n,a),i.transform&&"fixed"==s.getStyle(e.back,"position")){var p=e.backBlock=document.createElement("ins");p.style.display="none",e.back.parentNode.insertBefore(p,e.back),document.body.appendChild(e.back)}if(n=a,e.frontCSSBack=n.style.cssText,"fixed"!==f){var h=l.getSize(n);n.style.width=h.width+"px",n.style.height=h.height+"px",n.style.position="absolute",n.style.top=c.top+"px",n.style.left=c.left+"px"}document.body.appendChild(n),!!n.offsetWidth,u.push(e)}),u}function r(e,n,i,r){var o=p.viewport,a=n.main,s=a.parentNode;i.forEach(function(t){var e=t.front,n=t.frontBlock,i=n.parentNode;e.style.cssText+=";"+t.frontCSSBack+";opacity:1",i.insertBefore(e,n),i.removeChild(n)}),l.setStyles(a,{"float":"none",width:"auto",position:"static"}),o.appendChild(a),l.setStyles(e.main,{transition:""}),o.removeChild(s),i.forEach(function(t){if(t.backBlock){var e=t.backBlock;e.parentNode.insertBefore(t.back,e),e.parentNode.removeChild(e)}}),t("after",e,n),r.fulfill()}function o(t,n){var o=n.duration||p.duration,s=n.timing||p.timing,c=n.frontPage,l=n.backPage;n.transform=void 0!==n.transform?n.transform:p.transform;var d=e(c,l,n),m=i(c,l,n),v=[];m.forEach(function(t){v.push(f.transition(t.front,{opacity:0},{duration:t.change?o:.1,timing:s,delay:t.change?0:o}))});var g=n.direction==h.LEFT?0:-c.main.offsetWidth,y=n.transform?{transform:"translate3d("+g+"px, 0, 0)"}:{marginLeft:g+"px"},b=f.transition(d,y,{duration:o,timing:s});v.push(b),a.all(v).then(u(r,c,l,m,t))}var a=require("saber-promise"),s=require("saber-dom"),u=require("saber-lang/curry"),c=require("saber-lang/extend"),f=require("saber-run"),l=require("../util"),p=require("../config"),h={LEFT:"left",RIGHT:"right"},d={};return d.fixed={before:function(t,e){var i=t.getFixed();i=i.concat(e.getFixed());var r=t.getBar(),o=e.getBar(),a=n(r,o),u=c(r,o);Object.keys(u).forEach(function(t){if(a.indexOf(t)<0&&"fixed"==s.getStyle(u[t],"position"))i.push(u[t])}),this.fixedEles=i;var f,p,h,d=this.data=[],m=["top","left","right","bottom"];i.forEach(function(t){f={},m.forEach(function(e){f[e]=s.getStyle(t,e)}),d.push(f),h=s.position(t);for(var e=0,n=2;n>e;e++)if(p=parseInt(s.getStyle(t,"margin-"+m[e]),10),!isNaN(p))h[m[e]]-=p;l.setStyles(t,{position:"absolute",top:h.top+"px",left:h.left+"px",bottom:"0px"==f.bottom?"0px":"auto",right:"0px"==f.right?"0px":"auto"})})},after:function(){var t,e=this.data;this.fixedEles.forEach(function(n,i){t=e[i],l.setStyles(n,{position:"fixed",top:t.top||"auto",left:t.left||"auto",bottom:t.bottom||"auto",right:t.right||"auto"})})}},require("../transition").register("slide",o),o.RIGHT=h.RIGHT,o.LEFT=h.LEFT,o}),define("list/Action",function(require){function t(t){t=t||{},e(o,t.events||{}),t.events=o,r.call(this,t)}var e=require("saber-lang/extend"),n=require("saber-lang/bind"),i=require("saber-lang/inherits"),r=require("saber-firework/Action"),o={"view:more":function(){var t=this.view;this.model.more().then(n(t.add,t))}};return i(t,r),t}),define("saber-ajax/ajax",function(require){function t(t,e){var n=Object.keys(t).map(function(t){return t.toLowerCase()});return n.indexOf(e.toLowerCase())>=0}function e(){return new XMLHttpRequest}function n(t,e){Object.keys(t).forEach(function(n){e(n,t[n])})}function i(t){return"[object Function]"==Object.prototype.toString.call(t)}function r(t){return"[object String]"==Object.prototype.toString.call(t)}function o(t,e){return n(e,function(e,n){t[e]=n}),t}function a(t){n(g,function(e){t["on"+e]=null})}function s(t){var e;if(t.responseType&&t.responseType!==v)e=t.response;else e=t.responseText;return e}function u(t,e,n){this.xhr=t,this.promise=e.promise(),this.url=n.url,this.handleSuccess=!1,this.handleFail=!1,this.then(l(exports.emit,exports,"success",this),l(exports.emit,exports,"fail",this))}function c(t){var e=[];return t=t||{},n(t,function(t,n){e.push(t+"="+encodeURIComponent(n))}),e.join("&")}function f(a,s){var f=e();s=o({},s||{}),f.open(s.method||h,a,s.async||!0,s.username,s.password);var l=o(s.headers||{},{"X-Requested-With":"XMLHttpRequest"});if(s.method==d&&!t(l,"Content-Type"))l["Content-Type"]="application/x-www-form-urlencoded";n(l,function(t,e){f.setRequestHeader(t,e)});var p;if(p=s.responseType)f.responseType=m[p.toUpperCase()]||v;if(s.async!==!1&&s.timeout)f.timeout=s.timeout;var y=require("saber-promise"),b=new y;if(n(g,function(t,e){f["on"+t]=e(f,b)}),s.progress)if(i(s.progress))f.onprogress=s.progress;else if(s.progress.upload&&f.upload)f.upload.onprogress=s.progress.upload;else if(s.progress.download)f.onprogress=s.progress.download;if(s.before&&i(s.before)){var w=s.before(f,b);if(w===!1)return new u(f,b,s)}var E=s.data;if(window.FormData&&E instanceof FormData)f.send(E);else if(!r(E)&&s.stringify!==!1)f.send(c(E));else f.send(E);return s.url=a,new u(f,b,s)}var l=require("saber-lang/bind"),p=require("saber-emitter"),exports={};p.mixin(exports);var h="GET",d="POST",m={TEXT:"text",ARRAYBUFFER:"arraybuffer",DOCUMENT:"document",BLOB:"blob",JSON:"json"},v=m.TEXT,g={load:function(t,e){return function(){a(t);var n=t.status;if(n>=200&&300>n||304==n)e.fulfill(s(t));else e.reject(n)}},error:function(t,e){return function(){a(t),e.reject("error")}},abort:function(t,e){return function(){a(t),e.reject("abort")}},timeout:function(t,e){return function(){a(t),e.reject("timeout")}}};return u.prototype.then=function(t,e){return this.handleSuccess=this.handleSuccess||!!t,this.handleFail=this.handleFail||!!e,this.promise.then(t,e)},u.prototype.success=function(t){return this.handleSuccess=!0,this.then(t)},u.prototype.fail=function(t){return this.handleFail=!0,this.then(null,t)},u.prototype.ensure=function(t){return this.handleSuccess=this.handleFail=!0,this.then(t,t)},u.prototype.abort=function(){this.xhr.abort()},u.prototype.getData=function(){return s(this.xhr)},exports.get=function(t){var e={method:h};return f(t,e)},exports.post=function(t,e){var n={method:d,data:e};return f(t,n)},exports.request=f,exports}),define("saber-ajax",function(require){return require("saber-ajax/ajax")}),define("saber-ajax/ejson",function(require){function t(t,i){var o=new n,a=e.request(t,i);return a.then(function(t){try{if(t=JSON.parse(t),!t.status)o.fulfill(t.data);else o.reject(t)}catch(e){o.reject({status:r.DATA})}},function(t){if("string"==typeof t)t=r[t.toUpperCase()]||r.ERROR;o.reject({status:t})}),a.promise=o.promise(),a.handleSuccess=!1,a.handleFail=!1,a}var e=require("./ajax"),n=require("saber-promise"),i=require("saber-lang/extend"),r={DATA:1,ABORT:2,TIMEOUT:3,ERROR:4};return{get:function(e){var n={method:"GET"};return t(e,n)},post:function(e,n){var i={method:"POST",data:n};return t(e,i)},request:t,ERROR:i({},r)}}),define("saber-storage/storage",function(){var t,e,n,i,r,o;t="_SABER",e={OUT_OF_LIMIT:"Out of space limit"},n=function(){try{var t="localStorage"in window&&null!==window.localStorage,e={k:"test key",v:"test value"};if(t)localStorage.setItem(e.k,e.v),t=e.v===localStorage.getItem(e.k),localStorage.removeItem(e.k);return t}catch(n){return!1}}(),i=function(t){return JSON.stringify(t)},r=function(t){try{t=JSON.parse(t)}catch(e){}return t},o={data:{},setItem:function(t,e){this.data[t]=e},getItem:function(t){return this.data[t]},removeItem:function(t){delete this.data[t]}};var a=function(){};a.prototype={on:function(t,e){if("function"==typeof e){var n=this.events||(this.events={});return n[t]=n[t]||[],n[t].push(e),this}},emit:function(t){var e,n,i;if(e=this.events||(this.events={}),n=e[t],i=Array.prototype.slice.call(arguments,1),n){n=n.slice(0);for(var r=0,o=n.length;o>r;r++)n[r].apply(this,i)}return this}},a.mixin=function(t){for(var e in a.prototype)t[e]=a.prototype[e];return t};var s=function(e){opt=e||{},this.storageId=opt.storageId||t,this.memoryCache=!!opt.memoryCache,this.storage=n&&!this.memoryCache?window.localStorage:o};return s.Event=s.prototype.Event=e,s.prototype={isSupport:function(){return n},setItem:function(t,n){var r=this._getData();r[t]=n;try{return localStorage.setItem(this.storageId,i(r)),!0}catch(o){return this.emit(e.OUT_OF_LIMIT,o),!1}},getItem:function(t){return this._getData()[t]},removeItem:function(t){var e=this._getData();delete e[t],this.storage.setItem(this.storageId,i(e))},clear:function(){this.storage.removeItem(this.storageId)},key:function(){return Object.keys(this._getData())},_getData:function(){var t=this.storage.getItem(this.storageId);return t?r(t):{}}},a.mixin(s.prototype),s}),define("saber-storage",["saber-storage/storage"],function(t){return t}),define("list/Model",function(require){function t(t){var e=u.getItem(s)||[];t.forEach(function(t){var n=[t.points+" point"];if(t.points>1)n.push("s");if(n.push(", "+t.comments+" comment"),t.comments>1)n.push("s");t.meta=n.join(""),t.read=e.indexOf(t.id)>=0})}function e(t){this.data=[],o.call(this,t)}var n=require("saber-lang/inherits"),i=require("saber-promise"),r=require("saber-ajax/ejson"),o=require("saber-firework/Model"),a=require("saber-storage"),s="readlist",u=new a;return n(e,o),e.prototype.fetch=function(e){var n=this,i=this.url+(e.page?"?page="+e.page:"");return r.get(i).success(function(e){var i={};return i.list=e.data||[],t(i.list),n.data=n.data.concat(i.list),n.moreToken=e.condition.more,i.more=!!n.moreToken,i})},e.prototype.more=function(){var t=this.moreToken;if(t)return this.moreToken=null,this.fetch({page:t});else return i.rejected()},e}),define("list/hotModel",function(require){var t={};return t.constructor=require("./Model"),t.url="/feed/hotest",t}),define("list/View",function(require){function t(t){t=t||{},e(o,t.domEvents||{}),t.domEvents=o,r.call(this,t)}var e=require("saber-lang/extend"),n=require("saber-lang/inherits"),i=require("saber-dom"),r=require("saber-firework/View"),o={"click: .news-list-more":function(t){if(!i.hasClass(t,"loading"))i.addClass(t,"loading"),this.emit("more")
}};return n(t,r),t.prototype.add=function(t){var e=this.query(".news-list-more");i.removeClass(e,"loading"),i[t.more?"show":"hide"](e);var n=this.query(".news-list");n.innerHTML+=this.template.render("newsList",t)},t}),define("list/hot.tpl",function(){return'<!-- use: mainHeader(pageName=\'list_hot\', showNav=true) -->\n<div class="news-container">\n\n    <div class="news-list">\n        <!-- import: newsList -->\n    </div>\n\n    <!-- if: ${more} -->\n    <a class="news-list-more"></a>\n    <!-- /if -->\n\n</div>\n'}),define("list/hotView",function(require){var t={};return t.constructor=require("./View"),t.template=require("./hot.tpl"),t}),define("list/hot",function(require){var t={};return t.constructor=require("./Action"),t.model=require("./hotModel"),t.view=require("./hotView"),t}),define("list/newModel",function(require){var t={};return t.constructor=require("./Model"),t.url="/feed/newest",t}),define("list/new.tpl",function(){return'<!-- use: mainHeader(pageName=\'list_new\', showNav=true) -->\n<div class="news-container">\n\n    <div class="news-list">\n        <!-- import: newsList -->\n    </div>\n\n    <!-- if: ${more} -->\n    <a class="news-list-more"></a>\n    <!-- /if -->\n\n</div>\n'}),define("list/newView",function(require){var t={};return t.constructor=require("./View"),t.template=require("./new.tpl"),t}),define("list/new",function(require){var t={};return t.constructor=require("./Action"),t.model=require("./newModel"),t.view=require("./newView"),t}),define("post/indexModel",function(require){var t=require("saber-promise"),e=require("saber-ajax/ejson"),n="/post/",i={};return i.fetch=function(i){if(!i.id)return t.resolved({detail:{},comments:[]});var r=n+i.id;return e.get(r)},i}),define("post/index.tpl",function(){return'<!-- use: mainHeader(pageTitle=\'Comments\', showBack=true) -->\n<div class="post-container">\n    <div class="post-detail">\n\n        <h2 data-role="title">\n            <a href="${detail.url}" target="_blank">${detail.title}<i class="icon-external-link"></i></a>\n        </h2>\n\n        <!--  content -->\n        <!-- if: ${detail.content} -->\n        <div data-role="content" class="ui-content">\n            ${detail.content|raw}\n        </div>\n        <!-- /if -->\n\n        <div data-role="meta">\n            <span data-role="author">${detail.author}</span>\n            <span data-role="count">${detail.points} point<!-- if: ${detail.points} > 1 -->s<!-- /if --></span>\n            <span data-role="time">${detail.createDate}</span>\n        </div>\n    </div>\n\n    <div class="post-comments">\n        <!-- for: ${comments} as ${comment} -->\n        <div class="post-comment">\n            <div data-role="content" class="ui-content">${comment.content}</div>\n            <div data-role="meta">\n                <span data-role="author">${comment.author}</span>\n                <span data-role="count">${comment.points} point<!-- if: ${comment.points} > 1 -->s<!-- /if --></span>\n                <span data-role="time">${comment.createDate}</span>\n            </div>\n        </div>\n        <!-- /for -->\n    </div>\n</div>\n'}),define("post/indexView",function(require){var t={};return t.template=require("./index.tpl"),t}),define("post/index",function(require){var t={};return t.model=require("./indexModel"),t.view=require("./indexView"),t}),define("config",function(require){return[{path:"/index",action:require("./list/hot"),index:101,cached:!0},{path:"/list/new",action:require("./list/new"),index:102,cached:!0},{path:"/post/:id",action:require("./post/index"),index:201}]}),define("common/common.tpl",function(){return'<!-- target: mainHeader -->\n<!-- var: pageTitle = ${pageTitle} || \'Startup News\' -->\n<header class="ui-bar main-header" data-ui="primary header" data-viewport-bar="header" data-name="${pageTitle}">\n    <!-- if: ${showBack} -->\n    <a href="#" class="ui-btn" data-ui="primary icon-left">\n        <i class="icon-left"></i>\n        \n    </a>\n    <!-- /if -->\n    <h1 data-ui="title">${pageTitle}</h1>\n</header>\n\n<!-- if: ${showNav} -->\n<nav class="ui-bar main-nav" data-ui="subheader" data-viewport-bar="subheader">\n    <div class="ui-btns" data-ui="block">\n        <!-- if: ${pageName} == \'list_hot\' -->\n        <a class="ui-btn" data-ui="active"></a>\n        <!-- else -->\n        <a class="ui-btn" href="#/"></a>\n        <!-- /if -->\n\n        <!-- if: ${pageName} == \'list_new\' -->\n        <a class="ui-btn" data-ui="active"></a>\n        <!-- else -->\n        <a class="ui-btn" href="#/list/new"></a>\n        <!-- /if -->\n    </div>\n</nav>\n<!-- /if -->\n\n\n<!-- target: newsList -->\n<!-- for: ${list} as ${item}, ${index} -->\n\n<!-- if: ${item.comments} > 0 -->\n<a href="#/post/${item.id}" class="news-item">\n<!-- else -->\n<a href="${item.url}" target="_blank" class="news-item">\n<!-- /if -->\n\n    <span data-role="meta">\n        <span data-role="author">no.${item.no} by ${item.author}</span>\n        <span data-role="time">${item.createDate}</span>\n    </span>\n\n    <!-- if: ${item.read} -->\n    <h2 data-role="title" data-state="read">\n    <!-- else -->\n    <h2 data-role="title">\n    <!-- /if -->\n        ${item.title}\n        <!-- if: ${item.comments} > 0 -->\n            <i class="icon-comments"></i>\n        <!-- else -->\n            <i class="icon-external-link"></i>\n        <!-- /if -->\n    </h2>\n\n    <span data-role="meta">\n        <span data-role="count">${item.meta}</span>\n        <span data-role="host">${item.source}</span>\n    </span>\n</a>\n<!-- /for -->\n\n'}),define("app",function(require){var t=require("saber-dom"),e=require("saber-promise"),n=require("saber-firework"),i=require("saber-viewport/transition/slide");e.disableExceptionCapture(),n.load(require("./config")),n.on("afterload",function(){t.hide(t.g("splash-screen"))});var r={template:require("./common/common.tpl"),viewport:{transition:"slide"},processor:{transition:function(t,e){var n={};if(e=e||{},t.index&&e.index)n.direction=t.index>e.index?i.RIGHT:i.LEFT;return n}}};return{init:function(){n.start("viewport",r)}}});