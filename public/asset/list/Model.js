/*! 2014 Baidu Inc. All Rights Reserved */
define("list/Model",function(require){function t(t){var e=u.getItem(s)||[];t.forEach(function(t){var n=[t.points+" point"];if(t.points>1)n.push("s");if(n.push(", "+t.comments+" comment"),t.comments>1)n.push("s");t.meta=n.join(""),t.read=e.indexOf(t.id)>=0})}function e(t){this.data=[],o.call(this,t)}var n=require("saber-lang/inherits"),i=require("saber-promise"),r=require("saber-ajax/ejson"),o=require("saber-firework/Model"),a=require("saber-storage"),s="readlist",u=new a;return n(e,o),e.prototype.fetch=function(e){var n=this,i=this.url+(e.page?"?page="+e.page:"");return r.get(i).success(function(e){var i={};return i.list=e.data||[],t(i.list),n.data=n.data.concat(i.list),n.moreToken=e.condition.more,i.more=!!n.moreToken,i})},e.prototype.more=function(){var t=this.moreToken;if(t)return this.moreToken=null,this.fetch({page:t});else return i.rejected()},e});